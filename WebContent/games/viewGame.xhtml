<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h ="http://java.sun.com/jsf/html"
	  xmlns:f ="http://xmlns.jcp.org/jsf/core"
	  xmlns:p="http://primefaces.org/ui">
<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />

<title>#{gameMB.game.nmGame} - GameSystem</title>
</h:head>

<f:metadata>
	<f:viewParam name="g" value="#{gameMB.game.nmGame}"></f:viewParam>
	<f:viewParam name="p" value="#{gameMB.game.idPlataform}"></f:viewParam>
	<f:viewAction action="#{gameMB.startGamePage()}"></f:viewAction>
</f:metadata>

<h:body>
	
	<p:growl id="grGlobal" autoUpdate="true"></p:growl>
	
	<p:panelGrid columns="2">
		<p:outputLabel value="Game:"></p:outputLabel>
		<h:outputText value="#{gameMB.game.nmGame}"></h:outputText>
		
		<p:outputLabel value="id:"></p:outputLabel>
		<h:outputText value="#{gameMB.game.idGame}"></h:outputText>
		
		<p:outputLabel value="Plataforma:"></p:outputLabel>
		<h:outputText value="#{gameMB.game.nmPlataform}"></h:outputText>
		
		<p:outputLabel value="Desenvolvedor"></p:outputLabel>
		<h:outputText value="#{gameMB.game.nmDeveloper}"></h:outputText>
		
		<p:outputLabel value="Nota Média:"></p:outputLabel>
		<h:outputText value="#{gameMB.gameAvgGrade}"></h:outputText>
	</p:panelGrid>
	<br/>
	
	<h:form id="frmGrade">
		<p:panelGrid rendered="#{!gameMB.alreadyGradedbyUser}">
			<h2><h:outputLabel value="Dê sua avaliação!"></h:outputLabel></h2>
			<h:inputText value="#{gameMB.txtGrade}"></h:inputText>
			<p:commandButton value="Avaliar" action="#{gameMB.gradeGame}"></p:commandButton>
		</p:panelGrid>
	</h:form>
	
	<h:form id="frmComments">
		<p:panel header="Comentários">
			<p:dataList id="grdComments"
			value="#{gameMB.comments}" var="comment" 
			emptyMessage="Nenhum Comentário foi escrito para este jogo. Contribua com o seu!" 
			type="none" rows="20" 
			paginator="true" paginatorAlwaysVisible="false">
				
				<p:panelGrid style="width:100%">
					<p:row >
						<p:column><h:outputText id="commentTitle" value=">> por #{comment.nmUser} em #{comment.dtComment}"></h:outputText></p:column>						
					</p:row>
					<p:row>					
						<p:column colspan="2">
							<h:outputText id="txtRowComment" value="#{comment.deComment}" escape="false" ></h:outputText>													
						</p:column>
					</p:row>	
				</p:panelGrid>
				<br/>												
			</p:dataList>			
		</p:panel>
		<br/>
		
		<p:fieldset rendered="#{!gameMB.alreadyCommentedbyUser}" legend="Fazer Comentário" toggleable="true" toggleSpeed="500" collapsed="true">       
        		 <p:textEditor id="txtComment" value="#{gameMB.comment.deComment}" 
        		 				validatorMessage="Tamanho máximo 250 caracteres" 
        		 				required="true" 
        		 				requiredMessage="Preencha o comentário para continuar">
        		 	<f:validateLength maximum="250"></f:validateLength>
        		 </p:textEditor>
        		 <p:commandButton action="#{gameMB.createNewComment}" value="Enviar">
        		 </p:commandButton>
    	</p:fieldset>
	</h:form>
		
</h:body>
</html>